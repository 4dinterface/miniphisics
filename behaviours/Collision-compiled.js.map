{"version":3,"sources":["Collision.js"],"names":[],"mappings":"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","file":"Collision-compiled.js","sourcesContent":["\"use strict\";\r\n\r\nclass Collision {\r\n\r\n  /**\r\n   * �����������\r\n   * @param config\r\n   */\r\n  constructor(config) {\r\n    this.isBehaviour = true;\r\n  }\r\n\r\n  /**\r\n   * tick\r\n   * @param scene\r\n   * @param time\r\n   * @param interval\r\n   */\r\n  tick(scene, time, interval) {\r\n    var items = scene.items;\r\n\r\n    //������� ���� ����������� � ������� ����\r\n    for (let i = 0; i < items.length; i++) {\r\n      items[i].isCollisionState = false;\r\n    }\r\n\r\n    //�������� ��� ���� �� ������������\r\n    for (let i1 = 0; i1 < items.length; i1++) {\r\n      let item1 = items[i1];\r\n\r\n      for (var i2 = i1 + 1; i2 < items.length; i2++) { //�����������, � ���������� �� i �� ��� ����������, i1 ��� ��� ������� ������� ����������\r\n        let item2 = items[i2],\r\n            collision;\r\n\r\n        if (item1.type == \"BodyBox\" && item2.type == \"BodyCircle\") collision = this.collisionBoxAndBall(item1, item2);\r\n        if (item1.type == \"BodyCircle\" && item2.type == \"BodyBox\") collision = this.collisionBoxAndBall(item2, item1);\r\n        if (item1.type == \"BodyCircle\" && item2.type == \"BodyCircle\") collision = this.collisionBallAndBall(item1, item2);\r\n\r\n        //���� ������������ ���������� ������� ��������� �����������\r\n        if (collision) {\r\n          let napY = item2.pos.y - item1.pos.y; //���� item1 ������ �� >0, ���� item2 ������ ����� <0\r\n          let napX = item2.pos.x - item1.pos.x; //\r\n\r\n          //������� ���������� � item 1\r\n          if (napX < 0 && item1.v.x < 0) {\r\n            item1.v.x = item1.v.x * -item1.elast;\r\n            item1.isCollisionState = true;\r\n          }\r\n          if (napX > 0 && item1.v.x > 0) {\r\n            item1.v.x = item1.v.x * -item1.elast;\r\n            item1.isCollisionState = true;\r\n          }\r\n          if (napY < 0 && item1.v.y < 0) {\r\n            item1.v.y = item1.v.y * -item1.elast;\r\n            item1.isCollisionState = true;\r\n          }\r\n          if (napY > 0 && item1.v.y > 0) {\r\n            item1.v.y = item1.v.y * -item1.elast;\r\n            item1.isCollisionState = true;\r\n          }\r\n\r\n          //������� ����������� � item 2\r\n          if (napX > 0 && item2.v.x < 0) {\r\n            item2.v.x = item2.v.x * -item2.elast;\r\n            item2.isCollisionState = true;\r\n          }\r\n          if (napX < 0 && item2.v.x > 0) {\r\n            item2.v.x = item2.v.x * -item2.elast;\r\n            item2.isCollisionState = true;\r\n          }\r\n          if (napY > 0 && item2.v.y < 0) {\r\n            item2.v.y = item2.v.y * -item2.elast;\r\n            item2.isCollisionState = true;\r\n          }\r\n          if (napY < 0 && item2.v.y > 0) {\r\n            item2.v.y = item2.v.y * -item2.elast;\r\n            item2.isCollisionState = true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * �������� ������������ ���� �����\r\n   * @param ball1\r\n   * @param ball2\r\n   * @returns {boolean}\r\n   */\r\n  collisionBallAndBall(ball1, ball2) {\r\n    var r = Math.sqrt(Math.pow(ball1.pos.x - ball2.pos.x, 2) + Math.pow(ball1.pos.y - ball2.pos.y, 2));\r\n    if (r < ((ball1.d / 2) + (ball2.d / 2))) return true;\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * �������� �� ������������ ���� � ������\r\n   * @param box\r\n   * @param ball\r\n   * @returns {*}\r\n   */\r\n  collisionBoxAndBall(box, ball) {\r\n    var rectCenter = new Vector(box.width / 2, box.height / 2),\r\n        center = new Vector(ball.pos.x - box.pos.x, ball.pos.y - box.pos.y),\r\n        side = new Vector(Math.abs(center.x) - rectCenter.x, Math.abs(center.y) - rectCenter.y);\r\n\r\n    if (side.x <= ball.d / 2 && side.y <= ball.d / 2) return {\r\n      x: ball.d / 2 - (center.x - rectCenter.x),\r\n      y: ball.d / 2 - (side.y)\r\n    };\r\n    return false;\r\n  }\r\n\r\n}"]}